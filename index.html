<!DOCTYPE html>
<html lang="id">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Undangan Pernikahan - Via & Rifat</title>
        <link
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
            rel="stylesheet"
        />
        <link rel="stylesheet" href="style.css" />
    </head>
    <body>
        <!-- Opening Card -->
        <div class="opening-card" id="openingCard">
            <div class="opening-content">
                <h1>Via & Rifat</h1>
                <p>Kami mengundang Anda untuk berbagi kebahagia kami</p>
                <button class="open-invitation" onclick="openInvitation()">
                    <i class="fas fa-envelope-open"></i> Buka Undangan
                </button>
            </div>
        </div>

        <!-- Enhanced Audio Player -->
        <div class="audio-player" id="audioPlayer">
            <audio id="backgroundAudio" loop>
                <source src="wedding.mp3?v=2" type="audio/mp3" />
                <!-- Placeholder - you would replace with actual wedding music URL -->
            </audio>
            <div class="audio-controls">
                <button class="play-pause-btn" id="playPauseBtn">
                    <i class="fas fa-play" id="playIcon"></i>
                </button>
                <div class="volume-control">
                    <i class="fas fa-volume-up"></i>
                    <input
                        type="range"
                        class="volume-slider"
                        id="volumeSlider"
                        min="0"
                        max="100"
                        value="50"
                    />
                </div>
            </div>
            <div class="audio-title">♪ Musik Pernikahan</div>
        </div>

        <!-- Navigation -->
        <nav class="nav">
            <ul>
                <li>
                    <a href="#home"
                        ><i class="fas fa-home"></i><span>Beranda</span></a
                    >
                </li>
                <li>
                    <a href="#couple"
                        ><i class="fas fa-heart"></i><span>Pengantin</span></a
                    >
                </li>
                <li>
                    <a href="#event"
                        ><i class="fas fa-calendar"></i><span>Acara</span></a
                    >
                </li>
                <li>
                    <a href="#rsvp"
                        ><i class="fas fa-envelope"></i><span>RSVP</span></a
                    >
                </li>
            </ul>
        </nav>

        <!-- Hero Section -->
        <section id="home" class="hero">
            <div class="hero-content">
                <div class="bismillah">
                    بِسْمِ اللَّهِ الرَّحْمَنِ الرَّحِيم
                </div>
                <h1>Via & Rifat</h1>
                <p>Dengan mengharap rahmat dan ridho Allah SWT</p>
                <div class="date-info">
                    <i class="fas fa-calendar-heart"></i>
                    <strong>15 Agustus 2025</strong>
                </div>
            </div>
        </section>

        <!-- Couple Section -->
        <section id="couple" class="section couple">
            <div class="container">
                <h2 class="section-title">
                    Assalamu'alaikum Warahmatullahi Wabarakatuh
                </h2>
                <p
                    style="
                        text-align: center;
                        margin-bottom: 60px;
                        font-size: 1.3rem;
                        opacity: 0.9;
                        font-weight: 300;
                        line-height: 1.8;
                        color: #8b4513;
                    "
                >
                    Dengan memohon rahmat dan ridho Allah SWT, kami bermaksud
                    mengundang Bapak/Ibu/Saudara/i untuk menghadiri acara
                    pernikahan kami:
                </p>
                <div class="couple-container">
                    <div class="groom">
                        <div class="couple-photo"></div>
                        <div class="couple-name">Ma'arifat</div>
                        <div class="couple-parents">
                            Putra pertama dari<br />
                            Bapak Lukman dan Ibu Hasni (Rahimahallah)
                        </div>
                    </div>

                    <div class="ampersand">&</div>

                    <div class="bride">
                        <div class="couple-photo"></div>
                        <div class="couple-name">Selvia</div>
                        <div class="couple-parents">
                            Putri terakhir dari<br />
                            Bapak Afrianto dan Ibu Rosma
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Event Section -->
        <section id="event" class="section event">
            <div class="container">
                <h2 class="section-title">Waktu & Tempat Acara</h2>
                <div class="event-grid">
                    <div class="event-card">
                        <div class="event-icon">
                            <i class="fas fa-mosque"></i>
                        </div>
                        <div class="event-title">Akad Nikah</div>
                        <div class="event-details">
                            <p>
                                <i class="fas fa-calendar"></i> Jumat, 15
                                Agustus 2025
                            </p>
                            <p>
                                <i class="fas fa-clock"></i> 09.30 WIB - Selesai
                            </p>
                            <p>
                                <i class="fas fa-map-marker-alt"></i> Kantor KUA
                                Talamau - Pasaman Barat
                            </p>
                        </div>
                    </div>

                    <div class="event-card">
                        <div class="event-icon">
                            <i class="fas fa-utensils"></i>
                        </div>
                        <div class="event-title">Resepsi</div>
                        <div class="event-details">
                            <p>
                                <i class="fas fa-calendar"></i> Sabtu, 16
                                Agustus 2025
                            </p>
                            <p>
                                <i class="fas fa-clock"></i> 10.00 WIB - Selesai
                            </p>
                            <p>
                                <i class="fas fa-map-marker-alt"></i> Kediaman
                                mempelai wanita, Tinggam, Talamau - Pasaman
                                Barat
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- RSVP Section -->
        <section id="rsvp" class="section rsvp">
            <div class="container">
                <h2 class="section-title">Konfirmasi Kehadiran</h2>
                <div class="rsvp-container">
                    <div class="rsvp-form">
                        <form id="rsvpForm">
                            <div class="form-group">
                                <label for="name">
                                    <i class="fas fa-user"></i>
                                    Nama Lengkap *
                                </label>
                                <input
                                    type="text"
                                    id="name"
                                    name="name"
                                    required
                                    placeholder="Masukkan nama lengkap Anda"
                                />
                            </div>

                            <div class="form-group">
                                <label for="attendance">
                                    <i class="fas fa-check-circle"></i>
                                    Kehadiran *
                                </label>
                                <select
                                    id="attendance"
                                    name="attendance"
                                    required
                                >
                                    <option value="">Pilih kehadiran...</option>
                                    <option value="hadir">✅ Hadir</option>
                                    <option value="tidak-hadir">
                                        ❌ Tidak Hadir
                                    </option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="message">
                                    <i class="fas fa-heart"></i>
                                    Pesan & Doa
                                </label>
                                <textarea
                                    id="message"
                                    name="message"
                                    rows="4"
                                    placeholder="Berikan pesan dan doa terbaik untuk kami..."
                                ></textarea>
                            </div>

                            <button type="submit" class="btn">
                                <i class="fas fa-paper-plane"></i> Kirim
                                Konfirmasi
                            </button>
                        </form>
                    </div>

                    <div class="messages-section">
                        <h3 class="messages-title">
                            <i class="fas fa-comments"></i> Pesan & Doa
                        </h3>
                        <div id="messagesList">
                            <div class="no-messages">
                                <i class="fas fa-heart"></i>
                                <p>
                                    Belum ada pesan. Jadilah yang pertama
                                    memberikan doa dan ucapan!
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="rek">
            <div class="container">
                <div class="rek-container">
                    <div class="hadiah">
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            width="40"
                            height="40"
                            viewBox="0 0 14 14"
                        >
                            <g fill="none">
                                <path
                                    fill="#ffffff"
                                    d="M1.843 7H0v4l1.828 1.828A4 4 0 0 0 4.657 14H10.5a1.5 1.5 0 0 0 0-3h-3L4.672 8.172A4 4 0 0 0 1.843 7"
                                />
                                <path
                                    fill="#ffffff"
                                    fill-rule="evenodd"
                                    d="M6.255 9.754a.86.86 0 0 1-1.326 1.082l-1.45-1.45a.625.625 0 1 0-.884.884l1.45 1.45A2.11 2.11 0 0 0 7.502 11H7.5zM9.03.22a.75.75 0 1 0-1.06 1.06l.72.72H6.5a.5.5 0 0 0-.5.5v5a.5.5 0 0 0 .5.5h7a.5.5 0 0 0 .5-.5v-5a.5.5 0 0 0-.5-.5h-2.19l.72-.72A.75.75 0 0 0 10.97.22l-.97.97z"
                                    clip-rule="evenodd"
                                />
                                <path
                                    fill="rgba(255,255,255,0.7)"
                                    fill-rule="evenodd"
                                    d="M9.375 8V2h1.25v6z"
                                    clip-rule="evenodd"
                                />
                            </g>
                        </svg>
                        <h4>hadiah</h4>
                        <hr />
                        <p>
                            Bagi yang ingin mengirim tanda suka cita bisa
                            melalui no rekening berikut
                        </p>
                        <p
                            class="salin-text"
                            onclick="copyToClipboard('551801030768535')"
                        >
                            551801030768535
                        </p>
                        <h5>BRI</h5>
                        <p>Atas nama: MA'ARIFAT</p>
                    </div>
                    <div class="kado">
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            width="60"
                            height="60"
                            viewBox="0 0 128 128"
                        >
                            <path
                                fill="#f5b03e"
                                d="M16.4 31.73s-6.45.51-7.31 1.96c-.87 1.45-.92 3.68-.92 6.13c0 2.46-.1 8.1-.1 8.1l1.54 3.31s.29 42.19.29 43.5c0 1.3 0 2.89 1.88 3.9s49.66 24.09 51.15 24.71c2.25.93 3.32.58 3.32.58l53.09-88.79s-.17-2.43-2.38-3.01c-1.27-.32-100.56-.39-100.56-.39"
                            />
                            <path
                                fill="#e07f14"
                                d="M65.68 60.92c-.81 2.23-.44 25.29-.3 42.06c.14 16.76-.43 20.23 0 20.81s1.6.02 4.91-1.45c6.15-2.72 35.69-17.34 37.86-18.64s7.47-3.99 8.34-5.44s1.34-14.94 1.63-25.77c.29-10.84.58-19.51.58-19.51l1.3-3.9s-.28-10.54-.33-11.7c-.09-1.92-.3-2.91-.79-2.67c-.7.33-6.54 5.12-22 12.64c-9.71 4.71-30.64 12.03-31.2 13.57"
                            />
                            <path
                                fill="#fdd717"
                                d="M65.82 11.21c-4.33-.2-16.18 6.65-27.6 10.4S9.56 32.9 9.41 33.34c-.14.43 6.94 3.6 11.46 5.77c5.37 2.57 25.87 12.28 29.62 13.87c3.76 1.59 12.72 5.31 14.16 5.2c2.02-.14 21.1-7.66 30.78-12.28s21.78-11.78 21.94-13.52c.07-.78-17.8-7.45-26.71-11.48c-17.2-7.79-21.67-9.54-24.84-9.69"
                            />
                            <path
                                fill="#e37d14"
                                d="M8.12 49.77c.15 1.88 1.18 2.55 3.8 3.69s52.15 26.87 53.29 26.87s1.48-4.08.23-3.97c-.68.06-16.95-7.67-32.15-15.39C20.39 54.43 8.04 47.9 8.04 47.9z"
                            />
                            <path
                                fill="#ba5e0d"
                                d="M120.01 48.99S67.12 75.89 66.6 76.15s-1.35.17-1.35.17l-.04 4.01s.49.11 1.04-.06c.32-.1 52.23-26.97 52.46-27.05s1.23-.68 1.44-1.95c.18-1.02-.14-2.28-.14-2.28"
                            />
                            <path
                                fill="#af0f1b"
                                d="m28.86 97.42l10.35 15.4l4.53 1.55s.37-16.8.52-29.25c.21-18.19.13-34.78.39-35.72c.43-1.59 20.56-8.12 20.56-8.12S87.95 48.41 88.67 50c.32.7.07 12.48 0 26.21c-.09 17.34-.06 37.36-.06 37.36s2.35-.01 2.63-.88c.29-.87 1.45-7.58 1.45-7.58l8.82-58.79l4.48-5.78l-6.22-11.84l-25.52-12.56l-8.77 1.97l-9.49-1.45l-30.1 21.63l3.51 7.12l8.61 4.39z"
                            />
                            <path
                                fill="#dc0d28"
                                d="M91.28 49.39c-.55 1.21-.23 63.56-.23 63.56s2.75-1.52 6.29-3.22c3.52-1.69 6.05-2.74 6.27-3.62s.61-62.54.61-62.54z"
                            />
                            <path
                                fill="#ff2a23"
                                d="M41.35 48.1c.33.36-.21 65.06-.88 65.21c-.53.13-12.58-5.25-12.58-5.8s.97-62.38.97-62.38S40.37 47 41.35 48.1m23.88-33.85c-3.33 0-7.01.95-8.08 3.74s-1.31 6.94-1.31 10.04c0 2.97-.48 10.57 8.67 10.45s9.42-3.51 9.56-10.99c.12-6.24-.71-9.27-1.54-10.57c-.74-1.17-3.2-2.67-7.3-2.67"
                            />
                            <path
                                fill="#fcc9d2"
                                d="M59.94 29.69c2.08.12 2.97-4.45 4.57-6.95c1.6-2.49 3.27-4.16 2.67-5.46c-.49-1.08-4.84-1.43-7.19 1.84c-1.65 2.31-1.94 10.46-.05 10.57"
                            />
                            <path
                                fill="#ff2a23"
                                d="M73.33 16.42s2.95 3 3.72 8.88s-.12 10.45-.12 10.45s14.66-.44 19.72.53c4.99.97 6.73 3.17 6.73 4.77s-3.28 2.89-6.61 2.65s-5.58-.42-6 .42s.18 2.14 4.81 2.49c4.63.36 9.98-.3 11.64-6.06s1.72-15.74 1.13-22.93s-1.89-11.3-5.11-12.86c-3.39-1.63-11.88-1.9-19.9 2.61s-10.01 9.05-10.01 9.05"
                            />
                            <path
                                fill="#fcc9d2"
                                d="M89.94 9.58c-1.04-1.34-4.39-1.3-6.18.77c-1.9 2.2-2.32 10.57.12 11.05c2.76.54 2.26-3.98 4.28-6.77c1.98-2.73 2.79-3.74 1.78-5.05"
                            />
                            <path
                                fill="#ff2a23"
                                d="M56.38 16.71S45.15 3.62 32.32 3.82c-7.72.12-9.68 4.57-10.1 6.41s-3.62 20.14.65 30.05S36 47.62 37.39 47.3c1.78-.42 5.57-1.72 5.21-3.09s-12.95 3.56-13.07-2.08s8.91-6.24 13.07-6.36s11.29.83 11.29.83s-1.25-6.83-.42-11.7s2.91-8.19 2.91-8.19"
                            />
                            <path
                                fill="#fcc9d2"
                                d="M28.88 8.57c-1.6 1.66-2.26 11.23-1.25 15.98s1.9 6.77 3.98 6.36c1.74-.35 2.79-9.67 3.62-12.95c.89-3.5 3.09-7.22 2.2-8.85c-1.36-2.5-6.88-2.27-8.55-.54"
                            />
                        </svg>
                        <p>
                            Bagi yang ingin mengirim kado bisa mengirimkannya ke
                            alamat berikut:
                        </p>
                        <p>
                            Komplek masjid Raudathul Jannah, toko Al Aqsa. Jalan
                            Tuanku Tambusai Pekanbaru
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="footer">
            <div class="container">
                <div class="footer-verse">
                    وَمِنْ آيَاتِهِ أَنْ خَلَقَ لَكُم مِّنْ أَنفُسِكُمْ
                    أَزْوَاجًا لِّتَسْكُنُوا إِلَيْهَا
                </div>
                <div class="footer-translation">
                    "Dan di antara tanda-tanda kekuasaan-Nya ialah Dia ciptakan
                    untukmu isteri-isteri dari jenismu sendiri, supaya kamu
                    cenderung dan merasa tenteram kepadanya"
                </div>
                <p>&copy; 2025 Via & Rifat Wedding</p>
                <div class="social-links">
                    <a href="#" title="Instagram"
                        ><i class="fab fa-instagram"></i
                    ></a>
                    <a href="#" title="WhatsApp"
                        ><i class="fab fa-whatsapp"></i
                    ></a>
                    <a href="#" title="Facebook"
                        ><i class="fab fa-facebook"></i
                    ></a>
                </div>
            </div>
        </footer>

        <script>
            // Store messages in memory
            let messages = [];
            let isInvitationOpen = false;
            let audioPlaying = false;

            // Audio functionality
            const audio = document.getElementById("backgroundAudio");
            const playPauseBtn = document.getElementById("playPauseBtn");
            const playIcon = document.getElementById("playIcon");
            const volumeSlider = document.getElementById("volumeSlider");

            // Create a simple audio context for wedding music simulation
            let audioContext;
            let oscillator;
            let gainNode;

            function initAudio() {
                try {
                    audioContext = new (window.AudioContext ||
                        window.webkitAudioContext)();
                    gainNode = audioContext.createGain();
                    gainNode.connect(audioContext.destination);
                    gainNode.gain.value = 0.5;
                } catch (e) {
                    console.log("Audio context not supported");
                }
            }

            function playWeddingMusic() {
                if (!audioContext) return;

                oscillator = audioContext.createOscillator();
                oscillator.type = "sine";
                oscillator.frequency.setValueAtTime(
                    440,
                    audioContext.currentTime
                );
                oscillator.connect(gainNode);
                oscillator.start();

                // Create a simple melody pattern
                const melody = [
                    440, 493.88, 523.25, 587.33, 659.25, 698.46, 783.99, 880,
                ];
                let noteIndex = 0;

                const playNote = () => {
                    if (audioPlaying && oscillator) {
                        oscillator.frequency.setValueAtTime(
                            melody[noteIndex],
                            audioContext.currentTime
                        );
                        noteIndex = (noteIndex + 1) % melody.length;
                    }
                };

                setInterval(playNote, 800);
            }

            function stopWeddingMusic() {
                if (oscillator) {
                    oscillator.stop();
                    oscillator = null;
                }
            }

            // Opening invitation function
            function openInvitation() {
                const openingCard = document.getElementById("openingCard");
                openingCard.style.animation =
                    "openingCardSlide 2s ease-in-out forwards";

                setTimeout(() => {
                    openingCard.style.display = "none";
                    isInvitationOpen = true;
                    initAudio();

                    // Auto-play music after opening
                    setTimeout(() => {
                        toggleAudio();
                    }, 1000);
                }, 2000);
            }

            // Audio control functions
            function toggleAudio() {
                const audio = document.getElementById("backgroundAudio");

                if (audio.paused) {
                    audio.play();
                    playIcon.className = "fas fa-pause";
                } else {
                    audio.pause();
                    playIcon.className = "fas fa-play";
                }
            }

            // Event listeners for audio controls
            playPauseBtn.addEventListener("click", toggleAudio);

            volumeSlider.addEventListener("input", function () {
                if (gainNode) {
                    gainNode.gain.value = this.value / 100;
                }
            });

            // Enhanced smooth scrolling
            document.querySelectorAll('a[href^="#"]').forEach((link) => {
                link.addEventListener("click", function (e) {
                    e.preventDefault();
                    const target = document.querySelector(
                        this.getAttribute("href")
                    );
                    if (target) {
                        target.scrollIntoView({
                            behavior: "smooth",
                            block: "start",
                        });

                        // Enhanced visual feedback
                        this.style.transform = "scale(0.95)";
                        setTimeout(() => {
                            this.style.transform = "";
                        }, 200);
                    }
                });
            });

            // Enhanced Intersection Observer
            const observerOptions = {
                threshold: 0.1,
                rootMargin: "0px 0px -50px 0px",
            };

            const observer = new IntersectionObserver((entries) => {
                entries.forEach((entry, index) => {
                    if (entry.isIntersecting) {
                        setTimeout(() => {
                            entry.target.classList.add("visible");
                        }, index * 200);
                    }
                });
            }, observerOptions);

            document.querySelectorAll(".section").forEach((section) => {
                observer.observe(section);
            });

            // Enhanced date formatting
            function formatDateTime() {
                const now = new Date();
                const options = {
                    year: "numeric",
                    month: "long",
                    day: "numeric",
                    hour: "2-digit",
                    minute: "2-digit",
                    timeZone: "Asia/Jakarta",
                };
                return now.toLocaleDateString("id-ID", options) + " WIB";
            }

            // Enhanced message rendering
            function renderMessages() {
                const messagesList = document.getElementById("messagesList");

                if (messages.length === 0) {
                    messagesList.innerHTML = `
                    <div class="no-messages">
                        <i class="fas fa-heart"></i>
                        <p>Belum ada pesan. Jadilah yang pertama memberikan doa dan ucapan!</p>
                    </div>
                `;
                    return;
                }

                const messagesHTML = messages
                    .map(
                        (msg, index) => `
                <div class="message-item" style="animation-delay: ${
                    index * 0.1
                }s">
                    <div class="message-header">
                        <div class="message-name">
                            <i class="fas fa-user-circle"></i>
                            ${msg.name}
                        </div>
                        <div class="message-status ${
                            msg.attendance === "hadir"
                                ? "status-hadir"
                                : "status-tidak-hadir"
                        }">
                            <i class="fas ${
                                msg.attendance === "hadir"
                                    ? "fa-check-circle"
                                    : "fa-times-circle"
                            }"></i>
                            ${
                                msg.attendance === "hadir"
                                    ? "Hadir"
                                    : "Tidak Hadir"
                            }
                        </div>
                    </div>
                    ${
                        msg.message
                            ? `<div class="message-text">"${msg.message}"</div>`
                            : ""
                    }
                    <div class="message-time">
                        <i class="fas fa-clock"></i>
                        ${msg.timestamp}
                    </div>
                </div>
            `
                    )
                    .join("");

                messagesList.innerHTML = messagesHTML;
                messagesList.scrollTop = 0;
            }

            // Enhanced RSVP Form Handler
            document
                .getElementById("rsvpForm")
                .addEventListener("submit", function (e) {
                    e.preventDefault();

                    const submitBtn = this.querySelector(".btn");
                    const originalText = submitBtn.innerHTML;

                    // Enhanced loading state
                    submitBtn.innerHTML =
                        '<div class="loading"></div> Mengirim...';
                    submitBtn.disabled = true;

                    setTimeout(() => {
                        const formData = new FormData(this);
                        const data = {};
                        formData.forEach((value, key) => {
                            data[key] = value.trim();
                        });

                        // Enhanced validation
                        if (!data.name || !data.attendance) {
                            showNotification(
                                "Mohon lengkapi data yang wajib diisi (*)",
                                "error"
                            );
                            submitBtn.innerHTML = originalText;
                            submitBtn.disabled = false;
                            return;
                        }

                        if (data.name.length < 2) {
                            showNotification(
                                "Nama harus minimal 2 karakter",
                                "error"
                            );
                            submitBtn.innerHTML = originalText;
                            submitBtn.disabled = false;
                            return;
                        }

                        // Check existing messages
                        const existingMessageIndex = messages.findIndex(
                            (msg) =>
                                msg.name.toLowerCase() ===
                                data.name.toLowerCase()
                        );

                        if (existingMessageIndex !== -1) {
                            if (
                                confirm(
                                    "Nama sudah pernah mengirim pesan. Apakah ingin memperbarui pesan sebelumnya?"
                                )
                            ) {
                                messages[existingMessageIndex] = {
                                    ...messages[existingMessageIndex],
                                    attendance: data.attendance,
                                    message: data.message,
                                    timestamp: formatDateTime(),
                                };
                                showNotification(
                                    "Pesan Anda berhasil diperbarui! 🎉✨",
                                    "success"
                                );
                            } else {
                                submitBtn.innerHTML = originalText;
                                submitBtn.disabled = false;
                                return;
                            }
                        } else {
                            const newMessage = {
                                name: data.name,
                                attendance: data.attendance,
                                message: data.message,
                                timestamp: formatDateTime(),
                            };

                            messages.unshift(newMessage);

                            const successMessage =
                                data.attendance === "hadir"
                                    ? `Terima kasih ${data.name}! 🎉💕 Konfirmasi kehadiran Anda telah diterima. Kami menunggu kehadiran Anda di hari bahagia kami!`
                                    : `Terima kasih ${data.name}! 🙏💐 Meskipun tidak dapat hadir, kami sangat menghargai konfirmasi dan doa terbaik Anda.`;

                            showNotification(successMessage, "success");
                        }

                        renderMessages();
                        this.reset();
                        submitBtn.innerHTML = originalText;
                        submitBtn.disabled = false;

                        setTimeout(() => {
                            document
                                .querySelector(".messages-section")
                                .scrollIntoView({
                                    behavior: "smooth",
                                    block: "start",
                                });
                        }, 500);
                    }, 1000);
                });

            // Enhanced notification system
            function showNotification(message, type = "success") {
                document
                    .querySelectorAll(".notification")
                    .forEach((n) => n.remove());

                const notification = document.createElement("div");
                notification.className = `notification notification-${type}`;
                notification.style.cssText = `
                position: fixed;
                top: 30px;
                right: 30px;
                background: ${
                    type === "success"
                        ? "linear-gradient(135deg, #10b981, #059669)"
                        : "linear-gradient(135deg, #ef4444, #dc2626)"
                };
                color: white;
                padding: 25px 30px;
                border-radius: 20px;
                box-shadow: 0 15px 40px rgba(0,0,0,0.3);
                z-index: 10000;
                max-width: 450px;
                font-weight: 600;
                line-height: 1.6;
                animation: notificationSlideIn 0.6s ease-out;
                backdrop-filter: blur(15px);
                border: 2px solid rgba(139,69,19,0.2);
                font-size: 1rem;
            `;

                notification.innerHTML = `
                <div style="display: flex; align-items: flex-start; gap: 15px;">
                    <i class="fas ${
                        type === "success"
                            ? "fa-check-circle"
                            : "fa-exclamation-triangle"
                    }" 
                       style="font-size: 1.5rem; margin-top: 2px; flex-shrink: 0;"></i>
                    <div style="flex: 1;">${message}</div>
                    <button onclick="this.parentElement.parentElement.remove()" 
                            style="background: none; border: none; color: white; font-size: 1.5rem; 
                                   cursor: pointer; opacity: 0.8; padding: 0; margin-left: 15px; 
                                   transition: all 0.3s ease; flex-shrink: 0; border-radius: 50%; 
                                   width: 30px; height: 30px; display: flex; align-items: center; 
                                   justify-content: center;"
                            onmouseover="this.style.opacity='1'; this.style.background='rgba(255,255,255,0.2)'" 
                            onmouseout="this.style.opacity='0.8'; this.style.background='transparent'">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;

                if (!document.querySelector("#notification-styles")) {
                    const style = document.createElement("style");
                    style.id = "notification-styles";
                    style.textContent = `
                    @keyframes notificationSlideIn {
                        from {
                            transform: translateX(100%) scale(0.8);
                            opacity: 0;
                        }
                        to {
                            transform: translateX(0) scale(1);
                            opacity: 1;
                        }
                    }
                    @keyframes notificationSlideOut {
                        from {
                            transform: translateX(0) scale(1);
                            opacity: 1;
                        }
                        to {
                            transform: translateX(100%) scale(0.8);
                            opacity: 0;
                        }
                    }
                `;
                    document.head.appendChild(style);
                }

                document.body.appendChild(notification);

                setTimeout(() => {
                    if (notification.parentElement) {
                        notification.style.animation =
                            "notificationSlideOut 0.5s ease-out forwards";
                        setTimeout(() => notification.remove(), 500);
                    }
                }, 6000);
            }

            // Navigation highlight
            function initNavHighlight() {
                const sections = document.querySelectorAll("section");
                const navLinks = document.querySelectorAll(".nav a");

                window.addEventListener("scroll", () => {
                    let current = "";

                    sections.forEach((section) => {
                        const sectionTop = section.offsetTop;
                        if (scrollY >= sectionTop - 200) {
                            current = section.getAttribute("id");
                        }
                    });

                    navLinks.forEach((link) => {
                        link.classList.remove("active");
                        if (link.getAttribute("href") === `#${current}`) {
                            link.classList.add("active");
                        }
                    });
                });
            }

            // Initialize everything
            document.addEventListener("DOMContentLoaded", function () {
                renderMessages();
                initNavHighlight();

                // Enhanced mobile support
                if ("ontouchstart" in window) {
                    document.body.style.cursor = "pointer";

                    document.addEventListener("touchstart", function (e) {
                        const touch = e.touches[0];
                        const element = document.elementFromPoint(
                            touch.clientX,
                            touch.clientY
                        );

                        if (
                            element &&
                            (element.classList.contains("event-card") ||
                                element.classList.contains("groom") ||
                                element.classList.contains("bride") ||
                                element.classList.contains("btn"))
                        ) {
                            element.style.transform = "scale(0.98)";
                            setTimeout(() => {
                                element.style.transform = "";
                            }, 150);
                        }
                    });
                }

                // Keyboard navigation
                document.addEventListener("keydown", function (e) {
                    if (e.key === "ArrowDown" || e.key === "ArrowUp") {
                        const sections = Array.from(
                            document.querySelectorAll("section")
                        );
                        const currentIndex = sections.findIndex((section) => {
                            const rect = section.getBoundingClientRect();
                            return rect.top <= 100 && rect.bottom >= 100;
                        });

                        if (currentIndex !== -1) {
                            const nextIndex =
                                e.key === "ArrowDown"
                                    ? Math.min(
                                          currentIndex + 1,
                                          sections.length - 1
                                      )
                                    : Math.max(currentIndex - 1, 0);

                            sections[nextIndex].scrollIntoView({
                                behavior: "smooth",
                            });
                            e.preventDefault();
                        }
                    }

                    // Space bar for audio toggle
                    if (e.code === "Space" && e.target === document.body) {
                        e.preventDefault();
                        toggleAudio();
                    }
                });

                // Add scroll progress indicator
                const progressBar = document.createElement("div");
                progressBar.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 0%;
                    height: 3px;
                    background: linear-gradient(90deg, #D4AF37, #F4E4BC, #DDA0DD);
                    z-index: 10001;
                    transition: width 0.1s ease;
                    box-shadow: 0 2px 8px rgba(212,175,55,0.4);
                `;
                document.body.appendChild(progressBar);

                window.addEventListener("scroll", () => {
                    const scrollProgress =
                        (window.scrollY /
                            (document.documentElement.scrollHeight -
                                window.innerHeight)) *
                        100;
                    progressBar.style.width = scrollProgress + "%";
                });

                // Add page visibility API for pausing animations when tab is not active
                document.addEventListener("visibilitychange", () => {
                    if (document.hidden) {
                        // Pause audio when tab is hidden
                        if (audioPlaying) {
                            stopWeddingMusic();
                            playIcon.className = "fas fa-play";
                            audioPlaying = false;
                        }
                    }
                });

                // Performance monitoring
                if (window.performance) {
                    window.addEventListener("load", () => {
                        const loadTime =
                            window.performance.timing.loadEventEnd -
                            window.performance.timing.navigationStart;
                        console.log(`Page loaded in ${loadTime}ms`);
                    });
                }

                // Add error handling for missing resources
                window.addEventListener("error", (e) => {
                    console.warn("Resource loading error:", e.target);
                    // Continue gracefully without breaking the experience
                });
            });

            // Throttle function for performance optimization
            function throttle(func, wait) {
                let timeout;
                return function executedFunction(...args) {
                    const later = () => {
                        clearTimeout(timeout);
                        func(...args);
                    };
                    clearTimeout(timeout);
                    timeout = setTimeout(later, wait);
                };
            }

            // Optimized scroll performance
            const optimizedScrollHandler = throttle(function () {
                // Additional scroll-based animations can be added here
            }, 16); // 60fps

            window.addEventListener("scroll", optimizedScrollHandler);
        </script>
    </body>
</html>
